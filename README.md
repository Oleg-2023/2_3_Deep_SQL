# 2_3_Deep_SQL
## Задание
Напишите SQL-запрос, который выполняет следующие действия:
1. Возвращает список клиентов (имя и фамилия) с наибольшей общей суммой заказов.
2. Для каждого клиента из пункта 1 выводит список его заказов (номер заказа и общая сумма) в порядке убывания общей суммы заказов.
3.Выводит только тех клиентов, у которых общая сумма заказов превышает среднюю общую сумму заказов всех клиентов.

Важно использовать подзапросы, агрегатные функции и объединения таблиц, чтобы выполнить это задание. Оптимизируйте запрос, где это возможно.
## Реализация
1. Для расчета суммы всех заказов клиентов создаем временную таблицу __CustomerSums__
2. С помощью временной таблицы __CustomerSums__ определяем лидеров покупок, которые преобрели товаров на суммы большие, чем средняя сумма
   заказов по клиентам. Результат размещаем во временной таблице __Liders__
3. Формируем запрос отображающий Фамилию, имя клиента, номер(код) заказа, сумму заказа, общую сумму заказов клиента
   Таблицу __Orders__ соединяем с временной таблицей __Liders__
   Согласно занания сортируем записи в запросе по общей сумме заказов клиента в убывающем порядке, затем по клиенту и далее заказы по
   сумме заказа в убывающем порядке
   Последнее можно было бы выполнить с помощью оконной функции, но это лишние дополнительные вычисления.
    

